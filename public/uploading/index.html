<!DOCTYPE html>
<html lang="en" class="no-js">
	<head>
		<title>EJCS:Design Form</title>
		<link rel="stylesheet" type="text/css" href="css/default.css" />
		<link rel="stylesheet" type="text/css" href="css/component.css" />
		<link rel="stylesheet" type="text/css" href="css/load.css" />	
		<style type="text/css">

</style>
<script src="js/jquery.js"></script>
<script src="http://10.0.0.3:3000/socket.io/socket.io.js"></script>
<script>

var socket = io.connect('http://10.0.0.3:3000');

$("#loaderSub").html("<pre>Connecting to Server...</pre>");

socket.on("ClientTrigger",function(data){
	console.log(data);
	socket.emit("ClientTrigger",{Data:"TRIGGER"});
	console.log("Triggered Next File Transfer");
});

socket.on('news',function(data)
	{
		console.log(data);
	});
	
	socket.on('FTP_Error',function(data)
	{
		$("#loaderSub").html("<pre>Machine "+data.Data+" seems to be disconnected.</pre>");
		var r = confirm("Continue transfer to remaining machines?");
		if (r == true){
			socket.emit("ClientTrigger",{Data:"TRIGGER"});
			console.log("Triggered Next File Transfer");
		}
	    else
		    window.location="../home/";
	});

socket.on("TransRes",function(data){

	if(data.Data == "DONE"){
		$("#cancel").html("<button id='statusBtn' onclick='complete()'>DONE</button>");
		$("#loaderSub").html("<pre>Transfer Complete</pre>");
	}
	else
		$("#loaderSub").html("<pre>"+data.Data+"</pre>");
	console.log(data);
});

function cancelTrans()
{
socket.emit("CancelTrans",{"Data":"cancel"});
window.location="../home/";
console.log("Cancelling..");
}

function complete()
{
/* console.log("Cancelling.."); */
window.location="http://10.0.0.3:3000/home/";
}

</script>

	</head>
	<body>

		<div class="container">
			<header class="clearfix">
				<h1>Submit Design Files</h1>
			</header>
	



	<div class="loader" id="loader">
	<div class="loader__item">U</div>
  <div class="loader__item">P</div>
  <div class="loader__item">L</div>
  <div class="loader__item">O</div>
  <div class="loader__item">A</div>
  <div class="loader__item">D</div>
  <div class="loader__item">I</div>
  <div class="loader__item">N</div>
  <div class="loader__item">G</div>
  <div class="loader__item">&nbsp;</div>
  <div class="loader__item">F</div>
  <div class="loader__item">I</div>
  <div class="loader__item">L</div>
  <div class="loader__item">E</div>
  </div>
  <br><br>
  
  <div class ="loaderSub" id="loaderSub">
  <pre>Configuring Server for File Transfer.</pre>
  </div>
  
  <div id="cancel">
  <button id="statusBtn" onclick="cancelTrans()">CANCEL</button>
  </div>
		</div>
	</body>
	
	<script>
</script>
<script src="js/modernizr.custom.js"></script>
</html>
